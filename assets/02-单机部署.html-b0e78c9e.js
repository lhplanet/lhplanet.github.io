import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as d,o as l,c as t,a as n,b as a,d as s,e as i}from"./app-5d9be98b.js";const r={},c=n("h2",{id:"一、windows系统中的安装启动",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#一、windows系统中的安装启动","aria-hidden":"true"},"#"),a(" 一、Windows系统中的安装启动")],-1),p=n("h3",{id:"第一步-下载安装包",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#第一步-下载安装包","aria-hidden":"true"},"#"),a(" 第一步：下载安装包")],-1),m=n("p",null,"MongoDB 提供了可用于 32 位和 64 位系统的预编译二进制包，你可以从MongoDB官网下载安装，MongoDB 预编译二进制包下载地址：",-1),u={href:"https://www.mongodb.com/download-center#community",target:"_blank",rel:"noopener noreferrer"},v=n("figure",null,[n("img",{src:"https://lhplanet-1316168555.cos.ap-beijing.myqcloud.com/obsidian/202309200802358.png",alt:"",tabindex:"0",loading:"lazy"}),n("figcaption")],-1),b=n("p",null,"根据上图所示下载 zip 包。",-1),h={class:"hint-container tip"},g=n("p",{class:"hint-container-title"},"版本的选择",-1),k=n("ul",null,[n("li",null,"MongoDB的版本命名规范如：x.y.z；"),n("li",null,"y为奇数时表示当前版本为开发版，如：1.5.2、4.1.13；"),n("li",null,"y为偶数时表示当前版本为稳定版，如：1.6.3、4.0.10；"),n("li",null,"z是修正版本号，数字越大越好。")],-1),f={href:"http://docs.mongodb.org/manual/release-notes/#release-version-numbers",target:"_blank",rel:"noopener noreferrer"},_=i(`<h3 id="第二步-解压安装启动" tabindex="-1"><a class="header-anchor" href="#第二步-解压安装启动" aria-hidden="true">#</a> 第二步：解压安装启动</h3><p>将压缩包解压到一个目录中。</p><p>在解压目录中，手动建立一个目录用于存放数据文件，如 data/db</p><h4 id="方式1-命令行参数方式启动服务" tabindex="-1"><a class="header-anchor" href="#方式1-命令行参数方式启动服务" aria-hidden="true">#</a> 方式1：命令行参数方式启动服务</h4><p>在 bin 目录中打开命令行提示符，输入如下命令：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mongod <span class="token parameter variable">--dbpath</span><span class="token operator">=</span><span class="token punctuation">..</span><span class="token punctuation">\\</span>data<span class="token punctuation">\\</span>db
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>我们在启动信息中可以看到，mongoDB的默认端口是27017，如果我们想改变默认的启动端口，可以通过--port来指定端口。</p><p>为了方便我们每次启动，可以将安装目录的bin目录设置到环境变量的path中， bin 目录下是一些常用命令，比如 mongod 启动服务用的，mongo 客户端连接服务用的。</p><h4 id="方式2-配置文件方式启动服务" tabindex="-1"><a class="header-anchor" href="#方式2-配置文件方式启动服务" aria-hidden="true">#</a> 方式2：配置文件方式启动服务</h4><p>在解压目录中新建 config 文件夹，该文件夹中新建配置文件 mongod.conf ，内如参考如下：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>storage:
  <span class="token comment">#The directory where the mongod instance stores its data.Default Value is &quot;\\data\\db&quot; on Windows.</span>
  dbPath: D:<span class="token punctuation">\\</span>02_Server<span class="token punctuation">\\</span>DBServer<span class="token punctuation">\\</span>mongodb-win32-x86_64-2008plus-ssl-4.0.1<span class="token punctuation">\\</span>data
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>详细配置项内容可以参考官方文档：</p>`,12),x={href:"https://docs.mongodb.com/manual/reference/configuration-options/",target:"_blank",rel:"noopener noreferrer"},w=i(`<div class="hint-container warning"><p class="hint-container-title">注意</p><p>1）配置文件中如果使用双引号，比如路径地址，自动会将双引号的内容转义。如果不转义，则会报错：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>error-parsing-yaml-config-file-yaml-cpp-error-at-line-3-column-15-unknown-escape-character-d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>解决：</p><ol><li>对 \\ 换成 / 或 \\</li><li>如果路径中没有空格，则无需加引号。</li></ol><p>2）配置文件中不能以Tab分割字段</p><p>解决：</p><p>将其转换成空格。</p><p>启动方式：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mongod <span class="token parameter variable">-f</span> <span class="token punctuation">..</span>/config/mongod.conf
<span class="token comment"># 或</span>
mongod <span class="token parameter variable">--config</span> <span class="token punctuation">..</span>/config/mongod.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>更多参数配置：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>systemLog:
    destination: file
    #The path of the log file to which mongod or mongos should send all diagnostic logging information
    path: &quot;D:/02_Server/DBServer/mongodb-win32-x86_64-2008plus-ssl-4.0.1/log/mongod.log&quot;
    logAppend: true
storage:
    journal:
        enabled: true
    #The directory where the mongod instance stores its data.Default Value is &quot;/data/db&quot;.
    dbPath: &quot;D:/02_Server/DBServer/mongodb-win32-x86_64-2008plus-ssl-4.0.1/data&quot;
net:
    #bindIp: 127.0.0.1
    port: 27017
setParameter:
    enableLocalhostAuthBypass: false
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、shell连接-mongo命令" tabindex="-1"><a class="header-anchor" href="#二、shell连接-mongo命令" aria-hidden="true">#</a> 二、Shell连接(mongo命令)</h2><p>在命令提示符输入以下shell命令即可完成登陆</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mongo
<span class="token comment"># 或</span>
mongo <span class="token parameter variable">--host</span><span class="token operator">=</span><span class="token number">127.0</span>.0.1 <span class="token parameter variable">--port</span><span class="token operator">=</span><span class="token number">27017</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看已经有的数据库</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>show databases
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>退出mongodb</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">exit</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>更多参数可以通过帮助查看：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mongo <span class="token parameter variable">--help</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>MongoDB javascript shell是一个基于javascript的解释器，故是支持js程序的。</p></div></div><h2 id="三、compass-图形化界面客户端" tabindex="-1"><a class="header-anchor" href="#三、compass-图形化界面客户端" aria-hidden="true">#</a> 三、Compass-图形化界面客户端</h2><p>到MongoDB官网下载MongoDB Compass，地址：</p>`,3),y={href:"https://www.mongodb.com/download-center/v2/compass?initial=true",target:"_blank",rel:"noopener noreferrer"},D=i(`<p>如果是下载安装版，则按照步骤安装；如果是下载加压缩版，直接解压，执行里面的 MongoDBCompassCommunity.exe 文件即可。</p><p>在打开的界面中，输入主机地址、端口等相关信息，点击连接。</p><figure><img src="https://lhplanet-1316168555.cos.ap-beijing.myqcloud.com/obsidian/202309200819523.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="四、linux系统中的安装启动和连接" tabindex="-1"><a class="header-anchor" href="#四、linux系统中的安装启动和连接" aria-hidden="true">#</a> 四、Linux系统中的安装启动和连接</h2><p>目标：在Linux中部署一个单机的MongoDB，作为生产环境下使用。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>和Windows下操作差不多。</p></div><p>步骤如下：</p><h3 id="_1-先到官网下载压缩包-mongod-linux-x86-64-4-0-10-tgz-。" tabindex="-1"><a class="header-anchor" href="#_1-先到官网下载压缩包-mongod-linux-x86-64-4-0-10-tgz-。" aria-hidden="true">#</a> 1.先到官网下载压缩包 mongod-linux-x86_64-4.0.10.tgz 。</h3><h3 id="_2-上传压缩包到linux中-解压到当前目录" tabindex="-1"><a class="header-anchor" href="#_2-上传压缩包到linux中-解压到当前目录" aria-hidden="true">#</a> 2.上传压缩包到Linux中，解压到当前目录：</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">tar</span> <span class="token parameter variable">-xvf</span> mongodb-linux-x86_64-4.0.10.tgz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_3-移动解压后的文件夹到指定的目录中" tabindex="-1"><a class="header-anchor" href="#_3-移动解压后的文件夹到指定的目录中" aria-hidden="true">#</a> 3.移动解压后的文件夹到指定的目录中：</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mv</span> mongodb-linux-x86_64-4.0.10 /usr/local/mongodb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_4-新建几个目录-分别用来存储数据和日志" tabindex="-1"><a class="header-anchor" href="#_4-新建几个目录-分别用来存储数据和日志" aria-hidden="true">#</a> 4.新建几个目录，分别用来存储数据和日志：</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#数据存储目录</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /mongodb/single/data/db
<span class="token comment">#日志存储目录</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /mongodb/single/log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-新建并修改配置文件" tabindex="-1"><a class="header-anchor" href="#_5-新建并修改配置文件" aria-hidden="true">#</a> 5.新建并修改配置文件</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vi</span> /mongodb/single/mongod.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>配置文件的内容如下：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemLog:
  <span class="token comment">#MongoDB发送所有日志输出的目标指定为文件</span>
  <span class="token comment"># #The path of the log file to which mongod or mongos should send all diagnostic logging information</span>
  destination: <span class="token function">file</span>
  <span class="token comment">#mongod或mongos应向其发送所有诊断日志记录信息的日志文件的路径</span>
  path: <span class="token string">&quot;/mongodb/single/log/mongod.log&quot;</span>
  <span class="token comment">#当mongos或mongod实例重新启动时，mongos或mongod会将新条目附加到现有日志文件的末尾。</span>
  logAppend: <span class="token boolean">true</span>
storage:
  <span class="token comment">#mongod实例存储其数据的目录。storage.dbPath设置仅适用于mongod。</span>
  <span class="token comment">##The directory where the mongod instance stores its data.Default Value is &quot;/data/db&quot;.</span>
  dbPath: <span class="token string">&quot;/mongodb/single/data/db&quot;</span>
  journal:
    <span class="token comment">#启用或禁用持久性日志以确保数据文件保持有效和可恢复。</span>
    enabled: <span class="token boolean">true</span>
processManagement:
  <span class="token comment">#启用在后台运行mongos或mongod进程的守护进程模式。</span>
  fork: <span class="token boolean">true</span>
net:
  <span class="token comment">#服务实例绑定的IP，默认是localhost</span>
  bindIp: localhost,192.168.0.2
  <span class="token comment">#bindIp</span>
  <span class="token comment">#绑定的端口，默认是27017</span>
  port: <span class="token number">27017</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-启动mongodb服务" tabindex="-1"><a class="header-anchor" href="#_6-启动mongodb服务" aria-hidden="true">#</a> 6.启动MongoDB服务</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@bobohost single<span class="token punctuation">]</span><span class="token comment"># /usr/local/mongodb/bin/mongod -f /mongodb/single/mongod.conf</span>
about to fork child process, waiting <span class="token keyword">until</span> server is ready <span class="token keyword">for</span> connections.
forked process: <span class="token number">90384</span>
child process started successfully, parent exiting

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>如果启动后不是 successfully ，则是启动失败了。原因基本上就是配置文件有问题。</p></div><p>通过进程来查看服务是否启动了：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@bobohost single<span class="token punctuation">]</span><span class="token comment"># ps -ef |grep mongod</span>
root <span class="token number">90384</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">8</span>月26 ? 00:02:13 /usr/local/mongdb/bin/mongod <span class="token parameter variable">-f</span> /mongodb/single/mongod.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-分别使用mongo命令和compass工具来连接测试。" tabindex="-1"><a class="header-anchor" href="#_7-分别使用mongo命令和compass工具来连接测试。" aria-hidden="true">#</a> 7.分别使用mongo命令和compass工具来连接测试。</h3><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果远程连接不上，需要配置防火墙放行，或直接关闭linux防火墙</p></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#查看防火墙状态</span>
systemctl status firewalld
<span class="token comment">#临时关闭防火墙</span>
systemctl stop firewalld
<span class="token comment">#开机禁止启动防火墙</span>
systemctl disable firewalld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-停止关闭服务" tabindex="-1"><a class="header-anchor" href="#_8-停止关闭服务" aria-hidden="true">#</a> 8.停止关闭服务</h3><p>停止服务的方式有两种：快速关闭和标准关闭，下面依次说明：</p><h4 id="_1-快速关闭方法-快速-简单-数据可能会出错" tabindex="-1"><a class="header-anchor" href="#_1-快速关闭方法-快速-简单-数据可能会出错" aria-hidden="true">#</a> （1）快速关闭方法（快速，简单，数据可能会出错）</h4><p>目标：通过系统的kill命令直接杀死进程：</p><p>杀完要检查一下，避免有的没有杀掉。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#通过进程编号关闭节点</span>
<span class="token function">kill</span> <span class="token parameter variable">-2</span> <span class="token number">54410</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">说明</p><p>如果一旦是因为数据损坏，则需要进行如下操作（了解）：</p><p>1）删除lock文件：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">rm</span> <span class="token parameter variable">-f</span> /mongodb/single/data/db/*.lock
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>2）修复数据：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>/usr/local/mongdb/bin/mongod <span class="token parameter variable">--repair</span> <span class="token parameter variable">--dbpath</span><span class="token operator">=</span>/mongodb/single/data/db
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><h4 id="_2-标准的关闭方法-数据不容易出错-但麻烦" tabindex="-1"><a class="header-anchor" href="#_2-标准的关闭方法-数据不容易出错-但麻烦" aria-hidden="true">#</a> （2）标准的关闭方法（数据不容易出错，但麻烦）：</h4><p>目标：通过mongo客户端中的shutdownServer命令来关闭服务</p><p>主要的操作步骤参考如下：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>//客户端登录服务，注意，这里通过localhost登录，如果需要远程登录，必须先登录认证才行。
mongo <span class="token parameter variable">--port</span> <span class="token number">27017</span>
//<span class="token comment">#切换到admin库</span>
use admin
//关闭服务
db.shutdownServer<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,37);function B(q,M){const e=d("ExternalLinkIcon");return l(),t("div",null,[c,p,m,n("p",null,[n("a",u,[a("https://www.mongodb.com/download-center#community"),s(e)])]),v,b,n("div",h,[g,k,n("p",null,[a("详情："),n("a",f,[a("http://docs.mongodb.org/manual/release-notes/#release-version-numbers"),s(e)])])]),_,n("p",null,[n("a",x,[a("https://docs.mongodb.com/manual/reference/configuration-options/"),s(e)])]),w,n("p",null,[n("a",y,[a("https://www.mongodb.com/download-center/v2/compass?initial=true"),s(e)])]),D])}const L=o(r,[["render",B],["__file","02-单机部署.html.vue"]]);export{L as default};
